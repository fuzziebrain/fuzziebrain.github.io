"use strict";(self.webpackChunknewsite=self.webpackChunknewsite||[]).push([[8731],{54538:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var a=n(85893),s=n(11151);const i={title:"Making AI Accessible to APEX",tags:["oracle cloud","artificial intelligence","machine learning","orclapex","oci","natural language processing"],slug:"id/2010",authors:["fuzziebrain"],categories:["Technology","Infrastructure","Oracle Cloud"],date:new Date("2021-05-08T11:24:17.000Z")},o=void 0,r={permalink:"/content/id/2010",source:"@site/posts/making-ai-accessible-to-apex/index.md",title:"Making AI Accessible to APEX",description:"Figuring out sentiments.",date:"2021-05-08T11:24:17.000Z",formattedDate:"May 8, 2021",tags:[{label:"oracle cloud",permalink:"/content/tags/oracle-cloud"},{label:"artificial intelligence",permalink:"/content/tags/artificial-intelligence"},{label:"machine learning",permalink:"/content/tags/machine-learning"},{label:"orclapex",permalink:"/content/tags/orclapex"},{label:"oci",permalink:"/content/tags/oci"},{label:"natural language processing",permalink:"/content/tags/natural-language-processing"}],readingTime:5.3,hasTruncateMarker:!0,authors:[{name:"Adrian Png",title:"Senior Cloud Solutions Architect @ Insum",url:"https://github.com/fuzziebrain",imageURL:"https://github.com/fuzziebrain.png",key:"fuzziebrain"}],frontMatter:{title:"Making AI Accessible to APEX",tags:["oracle cloud","artificial intelligence","machine learning","orclapex","oci","natural language processing"],slug:"id/2010",authors:["fuzziebrain"],categories:["Technology","Infrastructure","Oracle Cloud"],date:"2021-05-08T11:24:17.000Z"},unlisted:!1,prevItem:{title:"ARM Your APEX Instance",permalink:"/content/id/2011"},nextItem:{title:"Manipulating the Oracle Cloud with PL/SQL",permalink:"/content/id/2009"}},l={authorsImageUrls:[void 0]},c=[{value:"Identity and Policy",id:"identity-and-policy",level:2},{value:"Demo Application",id:"demo-application",level:2}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",del:"del",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Figuring out sentiments.",src:n(44845).Z+"",width:"1200",height:"800"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.a,{href:"https://oracle.com/cloud/",children:(0,a.jsx)(t.em,{children:"Oracle Cloud Infrastructure"})})," (OCI) is a great platform in many ways. However, as much as I love it, I have long griped about the lack of out-of-the-box support for AI services that many of Oracle's competitors have. Well, as of May 6, 2021, I am glad to see that things are starting to turn around with the ",(0,a.jsx)(t.a,{href:"https://docs.oracle.com/iaas/releasenotes/changes/f801b1f5-b40d-49a5-bbb1-e2b2001ce2cf/",children:"launch"})," of the OCI ",(0,a.jsx)(t.em,{children:"Language"})," service."]}),"\n",(0,a.jsxs)(t.p,{children:['Today, there are different ways to "AI-enable" an ',(0,a.jsx)(t.a,{href:"https://apex.oracle.com",children:(0,a.jsx)(t.em,{children:"Oracle Application Express"})})," (APEX). For a long time now, Oracle has had several PL/SQL packages under the Oracle Enterprise Database's Machine Learning option, or what used to be known as Oracle Advanced Analytics. This option is in fact, ",(0,a.jsx)(t.a,{href:"https://blogs.oracle.com/database/machine-learning,-spatial-and-graph-no-license-required-v2",children:"no longer"})," an option and is included in all editions of the database."]}),"\n",(0,a.jsxs)(t.p,{children:["Specifically, ",(0,a.jsx)(t.a,{href:"https://www.oracle.com/database/technologies/datawarehouse-bigdata/oml4sql.html",children:(0,a.jsx)(t.em,{children:"Oracle Machine Learning for SQL"})})," (OML4SQL) allows the PL/SQL developer to train and apply ML models without the data leaving the database. It supports a variety of ML algorithms, and generally, does not require developers to have advanced theoretical knowledge of ML. And because it relies only on PL/SQL and SQL, it can be easily integrated into APEX. However, developers are limited to ML algorithms that have been implemented by Oracle."]}),"\n",(0,a.jsxs)(t.p,{children:["About a month ago, Oracle announced the general availability of ",(0,a.jsx)(t.em,{children:"AutoML"})," and ",(0,a.jsx)(t.em,{children:"OML Services"})," on the ",(0,a.jsx)(t.em,{children:"Autonomous Database"})," (ADB). Developers who are not too ML-savvy can use the AutoML UI (user interface), available through the Oracle Machine Learning Notebooks that is included with every ADB. AutoMl automates the process of selecting, training, testing, and evaluating ML models. The generated models can then be exposed through OML Services' REST APIs."]}),"\n",(0,a.jsxs)(t.p,{children:["However, sometimes, all we need is a ready-to-use AI/ML model that performs a rather generic task. Very common these days is the need to perform ",(0,a.jsx)(t.em,{children:"Sentiment Analysis"}),' on a body of text. Microsoft Azure\'s Cognitive Services has Text Analytics and AWS has Amazon Comprehend. What does Oracle have? At least now we can say, "OCI Language Services." It took a while, but better late than never!']}),"\n",(0,a.jsx)(t.h2,{id:"identity-and-policy",children:"Identity and Policy"}),"\n",(0,a.jsx)(t.p,{children:"As a best practice, we should create an OCI user specifically for interacting with the OCI REST API on behalf of the APEX application. The user should have limited OCI capabilities and should only be allowed to have API access and nothing more. You will need to generate the API keys and can easily do this from the user's details page in the OCI console."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Generate and download the API key pair from OCI console.",src:n(11138).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsxs)(t.p,{children:["You should also download the keys in PEM format. Also, gather the information (click the ",(0,a.jsx)(t.em,{children:"View Configuration File"})," link on the user's details page) that you will need to setup the APEX Web Credentials for OCI, specifically:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"User OCID"}),"\n",(0,a.jsx)(t.li,{children:"Tenant OCID; and"}),"\n",(0,a.jsx)(t.li,{children:"The API key's fingerprint"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Gather the OCI information that you will need.",src:n(26299).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsxs)(t.p,{children:["Open the private key that you had downloaded from the OCI console and remove (a) the enclosing tags ",(0,a.jsx)(t.code,{children:"-----BEGIN PRIVATE KEY-----"})," and ",(0,a.jsx)(t.code,{children:"-----END PRIVATE KEY-----"}),"; and (b) ",(0,a.jsx)(t.strong,{children:"all"})," newline characters. The end result should be a very long string of characters. This is the ",(0,a.jsx)(t.em,{children:"OCI Private Key"})," that you will need to provide in the APEX Web Credentials. Copy the text, but ",(0,a.jsx)(t.strong,{children:"do not"})," save the PEM file."]}),"\n",(0,a.jsx)(t.p,{children:"Create the Web Credentials with the required information about your user and tenancy."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Setup APEX Web Credentials.",src:n(35590).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsxs)(t.p,{children:["Next, create an IAM Group, e.g., ",(0,a.jsx)(t.em,{children:"AiLanguageUsers"}),", and assign the user to the group."]}),"\n",(0,a.jsx)(t.p,{children:"To use the Language Services, we will need to create a policy to allow users access. We have the option of creating a blanket policy with the following statement:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"allow any-user to use ai-service-language-family in tenancy\n"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"OR"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"allow group AiLanguageUsers to use ai-service-language-family in tenancy\n"})}),"\n",(0,a.jsx)(t.p,{children:"I recommend the latter."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Create a policy to allow a group access to the Language Services.",src:n(98140).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsx)(t.h2,{id:"demo-application",children:"Demo Application"}),"\n",(0,a.jsx)(t.p,{children:"Create a simple APEX application to demonstrate the utility of the Language Service through its REST API."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{src:n(48834).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsx)(t.p,{children:"The key items are:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Two textarea page items"}),"\n",(0,a.jsx)(t.li,{children:"A button that triggers a dynamic action"}),"\n",(0,a.jsx)(t.li,{children:"A dynamic action that sets one item using a PL/SQL function with the code below:"}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-sql",children:"declare\n  c_base_url constant varchar2(59) := 'https://language.aiservice.us-phoenix-1.oci.oraclecloud.com';\n  c_endpoint_path constant varchar2(50) := '/20210101/actions/detectLanguageSentiments';\n  c_web_credential constant varchar2(30) := 'DG_ADBAGENT01';\n\n  l_response clob;\nbegin\n  apex_web_service.g_request_headers(1).name := 'Content-Type';\n  apex_web_service.g_request_headers(1).value := 'application/json';\n\n  l_response := apex_web_service.make_rest_request(\n    p_url => c_base_url || c_endpoint_path\n      , p_http_method => 'POST'\n      , p_body => '{ \"text\": \"' || apex_escape.json(:P1_INPUT) || '\" }'\n      , p_credential_static_id => c_web_credential\n    );\n\n  return l_response;\nend;\n"})}),"\n",(0,a.jsx)(t.p,{children:"This DA simply takes the input text and makes a POST request to the appropriate endpoint for performing sentiment analysis. The expected output is a JSON containing the model's prediction."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"We made it!",src:n(45688).Z+"",width:"1280",height:"800"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsxs)(t.del,{children:["Unfortunately, it doesn't seem to work right now and I'm in touch with ",(0,a.jsx)(t.a,{href:"https://twitter.com/cczarski",children:"Carsten"})," to figure this out."]})}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.del,{children:"[TODO] I will update the post as soon as there's a positive outcome."})}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["[UPDATE, 2021-05-10] A noob error! I should have checked the debugger logs. As it turns out, I was missing the HTTP header ",(0,a.jsx)(t.code,{children:"Content-Type"}),". All systems go! The above code snippet and screenshot have been updated to reflect the success! Special thanks to ",(0,a.jsx)(t.a,{href:"https://twitter.com/cczarski",children:"Carsten"})," who helped validate that this REST call is supported and should have been successful."]}),"\n",(0,a.jsxs)(t.p,{children:["Meanwhile, I've tried looking at the OCI PL/SQL SDK that I had discussed in the ",(0,a.jsx)(t.a,{href:"/content/id/2009",children:"previous post"}),", but it doesn't appear to have been updated on my ADB."]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:"[TODO] I will also update this post as that becomes available."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"What's working though is the OCI CLI, but you will need to upgrade it to access the new commands. Here's an example and the output that we should have obtained through the example APEX application."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'$ oci ai language detect-sentiments --text "I feel great with the launch of OCI AI Language Services!"\n{\n  "data": {\n    "aspects": [\n      {\n        "length": 6,\n        "offset": 22,\n        "scores": {\n          "Negative": 0.0004437448224052787,\n          "Neutral": 0.0,\n          "Positive": 0.9995562434196472\n        },\n        "sentiment": "Positive",\n        "text": "launch"\n      },\n      {\n        "length": 24,\n        "offset": 32,\n        "scores": {\n          "Negative": 0.00011140753485960886,\n          "Neutral": 0.0,\n          "Positive": 0.99988853931427\n        },\n        "sentiment": "Positive",\n        "text": "OCI AI Language Services"\n      }\n]\n  }\n}\n'})}),"\n",(0,a.jsx)(t.p,{children:"Exciting times! As I have repeatedly said, the OCI keeps getting better. I'm certainly looking forward to resolving the issues I have encountered, and hopefully, more AI services to be launched in the near future!"}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Credits"})}),"\n",(0,a.jsxs)(t.p,{children:["Photo by ",(0,a.jsx)("a",{href:"https://unsplash.com/@markuswinkler?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText",children:"Markus Winkler"})," on ",(0,a.jsx)("a",{href:"https://unsplash.com/s/photos/emoji?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText",children:"Unsplash"})]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},45688:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/apex-we-got-there-5f09ec0dbf80b996fd222ca227ce3812.png"},48834:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/demo-page-ca194db60884f70b1042c0df7e4ba2cb.png"},44845:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/emoji-1200x800-d8d45696b386878f5cc9eabc625f019d.jpg"},26299:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/gather-information-87f5622a950a8956edf13604e40aae48.png"},11138:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/generate-download-api-keys-96cc67d2152726a764c819f68d2dc552.png"},98140:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/policy-b3b52e0a770a20b07507f469e41d6074.png"},35590:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/web-credentials-71cc4c78df4dc7ce1cd8059658f14425.png"},11151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>o});var a=n(67294);const s={},i=a.createContext(s);function o(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);