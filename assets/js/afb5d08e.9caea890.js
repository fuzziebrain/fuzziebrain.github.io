"use strict";(self.webpackChunknewsite=self.webpackChunknewsite||[]).push([[36006],{71945:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var r=a(85893),n=a(11151);const s={title:"Update Free SSL Certificates for the OCI Load Balancer",tags:["letsencrypt","ssl","security","certificates","load balancer","generate","renew"],slug:"id/2007",authors:["fuzziebrain"],categories:["Technology","Infrastructure","Oracle Cloud"],date:new Date("2020-09-14T21:59:11.000Z")},o=void 0,i={permalink:"/content/id/2007",source:"@site/posts/update-free-ssl-certificates-for-the-oci-load-balancer/index.md",title:"Update Free SSL Certificates for the OCI Load Balancer",description:"Keep Security Up to Date",date:"2020-09-14T21:59:11.000Z",formattedDate:"September 14, 2020",tags:[{label:"letsencrypt",permalink:"/content/tags/letsencrypt"},{label:"ssl",permalink:"/content/tags/ssl"},{label:"security",permalink:"/content/tags/security"},{label:"certificates",permalink:"/content/tags/certificates"},{label:"load balancer",permalink:"/content/tags/load-balancer"},{label:"generate",permalink:"/content/tags/generate"},{label:"renew",permalink:"/content/tags/renew"}],readingTime:1.97,hasTruncateMarker:!0,authors:[{name:"Adrian Png",title:"Senior Cloud Solutions Architect @ Insum",url:"https://github.com/fuzziebrain",imageURL:"https://github.com/fuzziebrain.png",key:"fuzziebrain"}],frontMatter:{title:"Update Free SSL Certificates for the OCI Load Balancer",tags:["letsencrypt","ssl","security","certificates","load balancer","generate","renew"],slug:"id/2007",authors:["fuzziebrain"],categories:["Technology","Infrastructure","Oracle Cloud"],date:"2020-09-14T21:59:11.000Z"},unlisted:!1,prevItem:{title:"New Book on Getting the Most Out of the Oracle Cloud Free Tier",permalink:"/content/id/2008"},nextItem:{title:"Keep Your APEX Images Updated",permalink:"/content/id/2006"}},c={authorsImageUrls:[void 0]},l=[];function h(e){const t={a:"a",blockquote:"blockquote",em:"em",img:"img",p:"p",...(0,n.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"Keep Security Up to Date",src:a(51207).Z+"",width:"2560",height:"1600"})}),"\n",(0,r.jsxs)(t.p,{children:["In my previous blog post on ",(0,r.jsx)(t.a,{href:"/content/id/2005/",children:"Running ORDS Against the Autonomous Database - Part 2"}),", we had looked at how to add an existing ",(0,r.jsx)(t.a,{href:"https://letsencrypt.org/",children:"Let's Encrypt"})," (LE) SSL certificate to an ",(0,r.jsx)(t.a,{href:"https://oracle.com/cloud",children:"Oracle Cloud Infrastructure"})," (OCI) Load Balancer. You'd typically wwant to host your websites or ",(0,r.jsx)(t.a,{href:"https://apex.oracle.com",children:"Oracle Application Express"})," applications over a secure transport layer, especially when sensitive data is communicated between the browser and server."]}),"\n",(0,r.jsxs)(t.p,{children:["Typically, I'd run scripts on the web server to generate and renew certificates using ",(0,r.jsx)(t.a,{href:"https://certbot.eff.org/",children:"Certbot"}),", since it would be easy enough to point the web server configuration to use the generated artifacts, as well as to perform service restarts. However, with the load balancer, this becomes more challenging. It doesn't help that LE certificates expire every 90 days."]}),"\n",(0,r.jsxs)(t.p,{children:["I've found it most reliable to run certbot from within a ",(0,r.jsx)(t.a,{href:"https://docker.com",children:"Docker"})," to avoid any dependency issues and you can quite easily get the published image on ",(0,r.jsx)(t.a,{href:"https://hub.docker.com/",children:"Docker Hub"})," including some with plugins to work directly with DNS services like ",(0,r.jsx)(t.a,{href:"https://cloudflare.com/",children:"Cloudflare"}),". These are important if you wanted to obtain wildcard certificates that requires a different challenge process."]}),"\n",(0,r.jsx)(t.p,{children:"Once the certificates have been generated, they would have to be deployed to the OCI load balancer and assigned to the active listener that supports HTTPS requests. You could do this manually through the OCI console, but it is a mundane and routine task that is prone to neglect, so I had to figure out a way to automate this part of the process."}),"\n",(0,r.jsxs)(t.p,{children:["On the web server, Certbot is usually called by a cron job once a day. It checks if a certificate is expiring and will initiate the renewal process if it is. It also has hooks that allow you to execute external scripts. For example, after a certificate is successfully generated or renewed, a ",(0,r.jsx)(t.em,{children:"post-hook"})," could be used to restart a web server."]}),"\n",(0,r.jsxs)(t.p,{children:["Using the Certbot hooks and the ",(0,r.jsx)(t.a,{href:"https://docs.cloud.oracle.com/iaas/Content/API/Concepts/cliconcepts.htm",children:"OCI CLI"}),", I created a Docker image that encapsulates both pieces of software, and then have them work together to perform both tasks in concert. You can find the code ",(0,r.jsx)(t.a,{href:"https://github.com/fuzziebrain/oci-le-cert-manager",children:"here"}),". The documentation is a little rough and lengthy, so I will leave you to read the steps described in the ",(0,r.jsx)(t.a,{href:"https://github.com/fuzziebrain/oci-le-cert-manager/blob/master/README.md",children:"README"})," file."]}),"\n",(0,r.jsx)(t.p,{children:"Hope this helps you maintain and secure your web applications!"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsx)("u",{children:"Photo Credits"}),"\n",(0,r.jsxs)(t.p,{children:["Photo by ",(0,r.jsx)(t.a,{href:"https://pixabay.com/users/Schluesseldienst-13794927/",children:"Schluesseldienst"}),"\nLicense: ",(0,r.jsx)(t.a,{href:"https://pixabay.com/service/license/",children:"Pixabay"})]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},51207:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/house-keys-4516178_1280-383c03a67d84f3db77f78343070fe841.jpg"},11151:(e,t,a)=>{a.d(t,{Z:()=>i,a:()=>o});var r=a(67294);const n={},s=r.createContext(n);function o(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);