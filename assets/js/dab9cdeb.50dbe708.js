"use strict";(self.webpackChunknewsite=self.webpackChunknewsite||[]).push([[45056],{3905:(e,t,a)=>{a.r(t),a.d(t,{MDXContext:()=>m,MDXProvider:()=>c,mdx:()=>g,useMDXComponents:()=>p,withMDXComponents:()=>d});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i.apply(this,arguments)}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var m=n.createContext({}),d=function(e){return function(t){var a=p(t.components);return n.createElement(e,i({},t,{components:a}))}},p=function(e){var t=n.useContext(m),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(m.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},x=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(a),c=r,u=d["".concat(o,".").concat(c)]||d[c]||h[c]||i;return a?n.createElement(u,l(l({ref:t},m),{},{components:a})):n.createElement(u,l({ref:t},m))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=x;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var m=2;m<i;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}x.displayName="MDXCreateElement"},916:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>m});var n=a(87462),r=(a(67294),a(3905));const i={title:"Mail Dropped",tags:["email","smtp","spf","orclapex","oxar","devops","linode"],slug:"id/1704",authors:["fuzziebrain"],categories:["Technology","Programming","Oracle Application Express"],date:new Date("2017-08-20T12:50:06.000Z")},o=void 0,l={permalink:"/content/id/1704",source:"@site/posts/mail-dropped/index.md",title:"Mail Dropped",description:"Screen capture of http://www.mail-tester.com/ Results",date:"2017-08-20T12:50:06.000Z",formattedDate:"August 20, 2017",tags:[{label:"email",permalink:"/content/tags/email"},{label:"smtp",permalink:"/content/tags/smtp"},{label:"spf",permalink:"/content/tags/spf"},{label:"orclapex",permalink:"/content/tags/orclapex"},{label:"oxar",permalink:"/content/tags/oxar"},{label:"devops",permalink:"/content/tags/devops"},{label:"linode",permalink:"/content/tags/linode"}],readingTime:9.165,hasTruncateMarker:!0,authors:[{name:"Adrian Png",title:"Senior Cloud Solutions Architect @ Insum",url:"https://github.com/fuzziebrain",imageURL:"https://github.com/fuzziebrain.png",key:"fuzziebrain"}],frontMatter:{title:"Mail Dropped",tags:["email","smtp","spf","orclapex","oxar","devops","linode"],slug:"id/1704",authors:["fuzziebrain"],categories:["Technology","Programming","Oracle Application Express"],date:"2017-08-20T12:50:06.000Z"},prevItem:{title:"Real Uptime Monitoring of Oracle APEX Instances",permalink:"/content/id/1705"},nextItem:{title:"The Community is One of Oracle APEX's Best Features",permalink:"/content/id/1703"}},s={authorsImageUrls:[void 0]},m=[{value:"Part One",id:"part-one",level:2},{value:"Email Relay",id:"email-relay",level:3},{value:"IPv6",id:"ipv6",level:3},{value:"Part Two",id:"part-two",level:2},{value:"Part Three",id:"part-three",level:2},{value:"Evaluate Your Email&#39;s Spamminess",id:"evaluate-your-emails-spamminess",level:3},{value:"Outcome",id:"outcome",level:3},{value:"Last Words",id:"last-words",level:2}],d={toc:m};function p(e){let{components:t,...i}=e;return(0,r.mdx)("wrapper",(0,n.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,r.mdx)("p",null,(0,r.mdx)("img",{alt:"Screen capture of http://www.mail-tester.com/ Results",src:a(52661).Z,width:"1280",height:"800"})),(0,r.mdx)("p",null,"Before I begin, I just wanted to be absolutely clear that this post has nothing to do with Apple's nifty ",(0,r.mdx)("a",{parentName:"p",href:"https://support.apple.com/kb/ph2629"},"tool")," for sending out large email attachments."),(0,r.mdx)("p",null,"In my previous ",(0,r.mdx)("a",{parentName:"p",href:"/content/id/cizx69jya000ra0pvv26u3cez/"},"post"),", I shared an approach for creating your very own ",(0,r.mdx)("a",{parentName:"p",href:"https://apex.oracle.com/"},"Oracle Application Express")," (APEX) instance on a small budget. Briefly, the solution involves using ",(0,r.mdx)("a",{parentName:"p",href:"https://www.vagrantup.com/"},"Vagrant")," to create a very affordable virtual machine (VM) on ",(0,r.mdx)("a",{parentName:"p",href:"https://www.linode.com/?r=41672b20d515344de465e9ed44c1a75356445597"},"Linode's")," pool of servers and run the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/OraOpenSource/OXAR"},"OXAR")," build script, to setup the APEX instance very quickly and painlessly."),(0,r.mdx)("p",null,"However, all that power (and savings) comes with great responsibilty. "),(0,r.mdx)("p",null,"Without the aid of managed services, the passionate APEX developer will have to handle the day-to-day administration of the system and database. One of the common tasks required of a developer is to ensure emails can be sent from APEX appplications successfully. This not only involves understanding how to use the APIs to generate and send emails, but also knowledge on maximizing the chance that emails are delivered successfully to the intended audience and do not end up in the spam bin."),(0,r.mdx)("p",null,"So what's involved in getting email setup on your OXAR instance?"),(0,r.mdx)("h2",{id:"part-one"},"Part One"),(0,r.mdx)("p",null,"Ensure that a suitable mail daemon is running on your server. If you used the method that I prescribed in my earlier post, then you would be running a ",(0,r.mdx)("a",{parentName:"p",href:"https://www.centos.org/"},"CentOS")," 7 server with ",(0,r.mdx)("a",{parentName:"p",href:"http://www.postfix.org/"},"Postfix")," installed, but not running on boot. Let's be sure by executing the following command:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo rpm -q postfix")),(0,r.mdx)("p",null,"If Postfix is installed, you should see an output with the full package name, e.g. ",(0,r.mdx)("inlineCode",{parentName:"p"},"postfix-2.10.1-6.el7.x86_64"),"."),(0,r.mdx)("p",null,"If absent, install it using yum by executing the command:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo yum install -y postfix")),(0,r.mdx)("p",null,"Next, check that the service is running by executing the command:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo systemctl is-active postfix")),(0,r.mdx)("p",null,"The screen output should provide some clues about whether the service has been started and/or enabled to start on boot:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"active")," ","\u21d2"," service is running"),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"inactive")," ","\u21d2"," service is not running but enabled"),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("inlineCode",{parentName:"li"},"unknown")," ","\u21d2"," service is not running and not enabled")),(0,r.mdx)("p",null,"If the service is in ",(0,r.mdx)("inlineCode",{parentName:"p"},"active")," state, then check that it is also enabled to start on boot by executing the command:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo systemctl is-enabled postfix")),(0,r.mdx)("p",null,"The system should respond with either ",(0,r.mdx)("inlineCode",{parentName:"p"},"enabled")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"disabled"),"."),(0,r.mdx)("p",null,"To enable the service to start on boot, execute:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo systemctl enable postfix")),(0,r.mdx)("p",null,"To start the service:\n",(0,r.mdx)("inlineCode",{parentName:"p"},"> sudo systemctl start postfix")),(0,r.mdx)("p",null,"Next, configure Postfix if necessary. In most situations, you can use Postfix to send emails directly. If that is the case, the default configuration should generally work just fine. "),(0,r.mdx)("h3",{id:"email-relay"},"Email Relay"),(0,r.mdx)("p",null,"Some developers have access to SMTP servers and might like to use them to circumvent spam-related issues. It would be prudent to assume that these servers, if exposed to remote requests, will require authentication. And because it is the Internet, using a secured network protocol to authenticate is highly recommended. If you have no problems setting up SSL/TLS support for SMTP connections, then you might not want to use Postfix at all. You can configure the SMTP host, port and credentials in the APEX Instance Administration. this is addressed in Part Two."),(0,r.mdx)("p",null,"However, if you are unable to set up a secure connection, then consider using Postfix by configuring it as a secure relay. I will use Gmail as an example. Here's what you need to do:"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},"Install Cyrus ",(0,r.mdx)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer"},"SASL")," plain authentication package:\n",(0,r.mdx)("inlineCode",{parentName:"li"},"> sudo yum install -y cyrus-sasl-plain")),(0,r.mdx)("li",{parentName:"ol"},"Execute the command:\n",(0,r.mdx)("inlineCode",{parentName:"li"},'> sudo echo "smtp.gmail.com myaccount@gmail.com:mysecurepassword" > /etc/postfix/sasl_passwd"')),(0,r.mdx)("li",{parentName:"ol"},"Execute the next command to hash the file to protect it from prying eyes:\n",(0,r.mdx)("inlineCode",{parentName:"li"},"> sudo postmap hash:/etc/postfix/sasl_passwd")),(0,r.mdx)("li",{parentName:"ol"},"Don't leave the plain text file lying around:\n",(0,r.mdx)("inlineCode",{parentName:"li"},"> sudo rm -f /etc/postfix/sasl_passwd")),(0,r.mdx)("li",{parentName:"ol"},"Configure Postfix stored in the configuration file ",(0,r.mdx)("inlineCode",{parentName:"li"},"/etc/postfix/main.cf"),". Place the following lines under the section ",(0,r.mdx)("em",{parentName:"li"},"INTERNET OR INTRANET"),":")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"smtp_sasl_auth_enable = yes\nsmtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd\nsmtp_sasl_security_options = noanonymous\nsmtp_tls_security_level = secure\nsmtp_tls_mandatory_protocols = TLSv1\nsmtp_tls_mandatory_ciphers = high\nsmtp_tls_secure_cert_match = nexthop\nsmtp_tls_CAfile = /etc/pki/tls/certs/ca-bundle.crt\nrelayhost = smtp.gmail.com:587\n")),(0,r.mdx)("ol",{start:6},(0,r.mdx)("li",{parentName:"ol"},"Restart Postfix:\n",(0,r.mdx)("inlineCode",{parentName:"li"},"> sudo systemctl restart postfix"))),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"IMPORTANT:")," To send emails using Gmail's SMTP servers, you may need to change your account access to ",(0,r.mdx)("a",{parentName:"p",href:"https://support.google.com/accounts/answer/6010255"},"allow access from less secure apps"),". "),(0,r.mdx)("p",null,(0,r.mdx)("em",{parentName:"p"},"Attribution: The method for configuring Postfix to relay emails through Gmail was adapted from Charles Auer's ",(0,r.mdx)("a",{parentName:"em",href:"https://charlesauer.net/tutorials/centos/postfix-as-gmail-relay-centos.php"},"post"),".")),(0,r.mdx)("h3",{id:"ipv6"},"IPv6"),(0,r.mdx)("p",null,"If you are not prepared to deal with IPv6 configuration and issues, then you might want to also limit the network protocol that Postfix uses. Update this configuration in ",(0,r.mdx)("inlineCode",{parentName:"p"},"/etc/postfix/main.cf")," and then restart the service."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre"},"inet_protocols = ipv4\n")),(0,r.mdx)("h2",{id:"part-two"},"Part Two"),(0,r.mdx)("p",null,"Configuring the APEX instance for email is simple. The documentation for how to do this is well documented in the ",(0,r.mdx)("a",{parentName:"p",href:"https://docs.oracle.com/database/apex-5.1/AEADM/configuring-instance-settings.htm#GUID-FEC98D5E-3C89-423E-9603-4CD2E553BA34"},"docs")," so I will not explain at length. In a nutshell:"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},"Login to the Instance Administration page"),(0,r.mdx)("li",{parentName:"ol"},"Click Manage Instance"),(0,r.mdx)("li",{parentName:"ol"},"Click Instance Settings"),(0,r.mdx)("li",{parentName:"ol"},"Click the Email tab"),(0,r.mdx)("li",{parentName:"ol"},"Enter the following:\na. SMTP Host Address - set to ",(0,r.mdx)("inlineCode",{parentName:"li"},"localhost"),"\nb. SMTP Host Port - set to ",(0,r.mdx)("inlineCode",{parentName:"li"},"25")," or whatever port you used in the Postfix configuration"),(0,r.mdx)("li",{parentName:"ol"},"Click Apply Changes to save"),(0,r.mdx)("li",{parentName:"ol"},'Ensure the proper network ACL has been set to allow the "APEX schema" to communicate with ',(0,r.mdx)("inlineCode",{parentName:"li"},"localhost"),".")),(0,r.mdx)("p",null,(0,r.mdx)("img",{alt:"Instance Administration - Instance Settings - Email",src:a(53412).Z,width:"1280",height:"800"})),(0,r.mdx)("p",null,"An easy way to test the service is to run the following procedure block using SQL Workshop's ",(0,r.mdx)("a",{parentName:"p",href:"https://docs.oracle.com/database/apex-5.1/AEUTL/SQL-commands.htm#AEUTL220"},"SQL Commands")," interface:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-sql"},"begin\n  apex_mail.send(\n    p_to => 'myfriend@email.com'\n    , p_from => 'me@myselfandi.com'\n    , p_subj => 'Popularity of Semantic Web Today'\n    , p_body => q'[\n        The 2017 Gartner Hype Cycle indicates that Semantic Web-related \n        technologies are heading past the trough of disillusionment. \n        We should investigate.\n]'\n    , p_body_html => q'[\n        <p>\n          The 2017 Gartner Hype Cycle indicates that Semantic Web-related \n          technologies are heading past the trough of disillusionment. We \n          should investigate.\n        </p>\n]'\n  );\n  apex_mail.push_queue;\nend;\n/\n")),(0,r.mdx)("h2",{id:"part-three"},"Part Three"),(0,r.mdx)("p",null,"The third and final piece that I'd like to talk about in this post is to get pass spam filters and allowing emails to arrive safely in your intended receipients' inbox."),(0,r.mdx)("p",null,"The following are a list of checks that spam filters typically use to assess an incoming email."),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"HELO Greeting Check"),(0,r.mdx)("li",{parentName:"ul"},"Reverse DNS Check"),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"http://www.openspf.org/"},"Sender Policy Framework")," (SPF)"),(0,r.mdx)("li",{parentName:"ul"},"Domain Keys (",(0,r.mdx)("a",{parentName:"li",href:"http://www.dkim.org/"},"DKIM"),")"),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"http://spamassassin.apache.org/"},"SpamAssassin")," content checks"),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Bounce_Address_Tag_Validation"},"BATV")," (Bounce Address Tag Validation)"),(0,r.mdx)("li",{parentName:"ul"},"Blacklisting",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"http://www.dnsbl.info/"},"DNSBL")," "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"http://uribl.com/"},"URIBL"))))),(0,r.mdx)("p",null,"The easiest checks to get past is ensuring that your DNS records are correct. The HELO greeting simply checks that your domain has a valid forward and reverse entry. The latter might be a little harder to achieve since PTR records, reverse DNS mappings, are usually managed by the organization that issued the IP address. Most spam filters recognize this and would accept the email as long as there is one. "),(0,r.mdx)("p",null,"The single most important factor seems to be how the SPF records are set for your domain. It's not difficult for anyone to setup a SMTP server and with an appropriate email api/client, spoof a domain that he/she does not own and send out unauthorized emails. For example, if your APEX application attempts to use an ",(0,r.mdx)("em",{parentName:"p"},"@yahoo.com")," or ",(0,r.mdx)("em",{parentName:"p"},"@gmail.com")," email address sent from an unauthorized SMTP server, then these emails will likely be flagged as spam. Servers with strict policies might even outrightly reject these emails."),(0,r.mdx)("p",null,"SPF is a ",(0,r.mdx)("strong",{parentName:"p"},"single")," ",(0,r.mdx)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/TXT_record"},"TXT")," record in the DNS that uses ",(0,r.mdx)("a",{parentName:"p",href:"http://www.openspf.org/Mechanisms"},"mechanisms")," to help verify if the incoming email originated from an authorized source. Commonly used mechanisms include: ",(0,r.mdx)("inlineCode",{parentName:"p"},"a"),", ",(0,r.mdx)("inlineCode",{parentName:"p"},"mx"),", ",(0,r.mdx)("inlineCode",{parentName:"p"},"include"),", ",(0,r.mdx)("inlineCode",{parentName:"p"},"ip4")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"all"),". Each mechanism in the record can have one of four qualifiers (",(0,r.mdx)("inlineCode",{parentName:"p"},"-")," ","\u21d2"," fail, ",(0,r.mdx)("inlineCode",{parentName:"p"},"~")," ","\u21d2"," softfail, ",(0,r.mdx)("inlineCode",{parentName:"p"},"+")," ","\u21d2"," pass or ",(0,r.mdx)("inlineCode",{parentName:"p"},"?")," ","\u21d2"," neutral) that email filters could then use to decide on whether to flag as spam. "),(0,r.mdx)("p",null,"Below is the SPF record for the domain ",(0,r.mdx)("inlineCode",{parentName:"p"},"bcoug.org"),". It begins with the SPF version number and then six mechanisms. Five of them state different ways to resolve an authorized source. The last is a catch-all to state that the email source is unauthorized."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"v=spf1 a mx include:_spf.google.com include:servers.mcsv.net ip4:204.244.186.184/32 ~all\n")),(0,r.mdx)("p",null,"Before adding a SPF record to your DNS, test it first using the ",(0,r.mdx)("a",{parentName:"p",href:"http://www.kitterman.com/spf/validate.html"},"tool")," provided by Kitterman. Add it to your DNS only when the SPF record validates successfully and can correctly identify your SMTP server as an authorized server for the specified domain. "),(0,r.mdx)("p",null,(0,r.mdx)("img",{alt:"Inputs to test a what-if email was sent from my personal APEX instance",src:a(64912).Z,width:"1280",height:"800"})),(0,r.mdx)("p",null,(0,r.mdx)("img",{alt:"Results",src:a(66866).Z,width:"1280",height:"223"})),(0,r.mdx)("p",null,"After adding the SPF record, check to see if the record is being read correcly. You can use ",(0,r.mdx)("a",{parentName:"p",href:"https://mxtoolbox.com/"},"MxToolBox")," for this. Here's what the SPF record for the domain ",(0,r.mdx)("inlineCode",{parentName:"p"},"bcoug.org")," looks like:"),(0,r.mdx)("table",null,(0,r.mdx)("thead",{parentName:"table"},(0,r.mdx)("tr",{parentName:"thead"},(0,r.mdx)("th",{parentName:"tr",align:null},"Prefix"),(0,r.mdx)("th",{parentName:"tr",align:null},"Type"),(0,r.mdx)("th",{parentName:"tr",align:null},"Value"),(0,r.mdx)("th",{parentName:"tr",align:null},"PrefixDesc"),(0,r.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,r.mdx)("tbody",{parentName:"table"},(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"v"),(0,r.mdx)("td",{parentName:"tr",align:null},"version"),(0,r.mdx)("td",{parentName:"tr",align:null},"spf1"),(0,r.mdx)("td",{parentName:"tr",align:null}),(0,r.mdx)("td",{parentName:"tr",align:null},"The SPF record version")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"+"),(0,r.mdx)("td",{parentName:"tr",align:null},"a"),(0,r.mdx)("td",{parentName:"tr",align:null}),(0,r.mdx)("td",{parentName:"tr",align:null},"Pass"),(0,r.mdx)("td",{parentName:"tr",align:null},"Match if IP has a DNS 'A' record in given domain")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"+"),(0,r.mdx)("td",{parentName:"tr",align:null},"mx"),(0,r.mdx)("td",{parentName:"tr",align:null}),(0,r.mdx)("td",{parentName:"tr",align:null},"Pass"),(0,r.mdx)("td",{parentName:"tr",align:null},"Match if IP is one of the MX hosts for given domain name")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"+"),(0,r.mdx)("td",{parentName:"tr",align:null},"include"),(0,r.mdx)("td",{parentName:"tr",align:null},"_spf.google.com"),(0,r.mdx)("td",{parentName:"tr",align:null},"Pass"),(0,r.mdx)("td",{parentName:"tr",align:null},"The specified domain is searched for an 'allow'.")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"+"),(0,r.mdx)("td",{parentName:"tr",align:null},"include"),(0,r.mdx)("td",{parentName:"tr",align:null},"servers.mcsv.net"),(0,r.mdx)("td",{parentName:"tr",align:null},"Pass"),(0,r.mdx)("td",{parentName:"tr",align:null},"The specified domain is searched for an 'allow'.")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"+"),(0,r.mdx)("td",{parentName:"tr",align:null},"ip4"),(0,r.mdx)("td",{parentName:"tr",align:null},"204.244.186.184/32"),(0,r.mdx)("td",{parentName:"tr",align:null},"Pass"),(0,r.mdx)("td",{parentName:"tr",align:null},"Match if IP is in the given range")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},"~"),(0,r.mdx)("td",{parentName:"tr",align:null},"all"),(0,r.mdx)("td",{parentName:"tr",align:null}),(0,r.mdx)("td",{parentName:"tr",align:null},"SoftFail"),(0,r.mdx)("td",{parentName:"tr",align:null},"Always matches. It goes at the end of your record.")))),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"NOTE:")," Since ",(0,r.mdx)("inlineCode",{parentName:"p"},"bcoug.org")," resolves to IPv4 ",(0,r.mdx)("inlineCode",{parentName:"p"},"204.244.186.184"),", the ip4 mechanism can be omitted."),(0,r.mdx)("h3",{id:"evaluate-your-emails-spamminess"},"Evaluate Your Email's Spamminess"),(0,r.mdx)("p",null,"Here's a bunch of tools I gathered from websites and ",(0,r.mdx)("a",{parentName:"p",href:"https://stackoverflow.com/"},"stackoverflow")," posts that are useful for evaluating your emails (content, SPF records etc.) and creating an actionalble checklist. They have helped me quite a bit, so I'm counting on them to do the same for you!"),(0,r.mdx)("table",null,(0,r.mdx)("thead",{parentName:"table"},(0,r.mdx)("tr",{parentName:"thead"},(0,r.mdx)("th",{parentName:"tr",align:null},"Link"),(0,r.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,r.mdx)("tbody",{parentName:"table"},(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("a",{parentName:"td",href:"http://www.mail-tester.com/"},"http://www.mail-tester.com/")),(0,r.mdx)("td",{parentName:"tr",align:null},"Create an email and send it through your designated SMTP server.")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("a",{parentName:"td",href:"http://www.allaboutspam.com/"},"http://www.allaboutspam.com/")),(0,r.mdx)("td",{parentName:"tr",align:null},"Like Mail Tester, send an email through your designated SMTP server.")),(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("a",{parentName:"td",href:"http://spamcheck.postmarkapp.com/"},"http://spamcheck.postmarkapp.com/")),(0,r.mdx)("td",{parentName:"tr",align:null},"Copy and paste an email with its headers to get a SpamAssassin score.")))),(0,r.mdx)("h3",{id:"outcome"},"Outcome"),(0,r.mdx)("p",null,"After taking my APEX instance through cycles of corrective actions, I was finally able to achieve a score of 9/10. Where I fell short of a perfect score, is the absence of ",(0,r.mdx)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/DomainKeys"},"DomainKeys")," (DKIM) information. I have yet to implement DKIM support for my APEX instance, so stay tuned, and you can expect a follow up howto post."),(0,r.mdx)("p",null,(0,r.mdx)("img",{alt:"Results after the appropriate SPF records are added",src:a(53509).Z,width:"1280",height:"800"})),(0,r.mdx)("h2",{id:"last-words"},"Last Words"),(0,r.mdx)("p",null,"I hope this information here saves you some time figuring out what you need to do to stay out of the junk mail folder. Before I end though, here are a few more notes: "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Watch your content, even when performing checks on the validity of your emails."),(0,r.mdx)("li",{parentName:"ul"},"Include HTML content and make sure there are no broken links if any."),(0,r.mdx)("li",{parentName:"ul"},"Do your best to stay off any blacklists. It's a huge challenge getting your mail server delisted.")))}p.isMDXComponent=!0},53509:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/after-7304616b3692cb91848841c3b2df3861.png"},53412:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/apex-email-settings-45ad140ef509e86c144d5e7c4b7bad37.png"},52661:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/before-ce7401b7b5ad883fd2e80ce2e2769278.png"},64912:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/spf-validate-form-e4609fe1fa8c68bcea84be93cdfd74c2.png"},66866:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/spf-validate-results-2669bb36f5738fe7f9392d7b8098fb2b.png"}}]);