"use strict";(self.webpackChunknewsite=self.webpackChunknewsite||[]).push([[54222],{3905:(e,t,r)=>{r.r(t),r.d(t,{MDXContext:()=>s,MDXProvider:()=>m,mdx:()=>g,useMDXComponents:()=>d,withMDXComponents:()=>c});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},o.apply(this,arguments)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){return function(t){var r=d(t.components);return a.createElement(e,o({},t,{components:r}))}},d=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},m=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},h="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),c=d(r),m=n,h=c["".concat(i,".").concat(m)]||c[m]||u[m]||o;return r?a.createElement(h,l(l({ref:t},s),{},{components:r})):a.createElement(h,l({ref:t},s))}));function g(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=f;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[h]="string"==typeof e?e:n,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}f.displayName="MDXCreateElement"},10400:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=r(87462),n=(r(67294),r(3905));const o={title:"Generating XSL-FO Layouts with Microsoft Word and Apache POI",tags:["Apache POI","Java","Microsoft Word","Oracle Application Express","Oracle BI Publisher","PDF","reporting","XPath","XSL-FO"],slug:"id/332",authors:["fuzziebrain"],comment:!1,categories:["Technology","Programming","Oracle Application Express"],date:new Date("2013-05-31T20:53:46.000Z")},i=void 0,l={permalink:"/content/id/332",source:"@site/posts/generating-xsl-fo-layouts-with-microsoft-word-and-apache-poi/index.md",title:"Generating XSL-FO Layouts with Microsoft Word and Apache POI",description:"The objective of this post is to describe how to create XSL-FO Layouts with little or no costs! These can then be used\xa0for custom PDF documents\xa0printing in Oracle Application Express (APEX).",date:"2013-05-31T20:53:46.000Z",formattedDate:"May 31, 2013",tags:[{label:"Apache POI",permalink:"/content/tags/apache-poi"},{label:"Java",permalink:"/content/tags/java"},{label:"Microsoft Word",permalink:"/content/tags/microsoft-word"},{label:"Oracle Application Express",permalink:"/content/tags/oracle-application-express"},{label:"Oracle BI Publisher",permalink:"/content/tags/oracle-bi-publisher"},{label:"PDF",permalink:"/content/tags/pdf"},{label:"reporting",permalink:"/content/tags/reporting"},{label:"XPath",permalink:"/content/tags/x-path"},{label:"XSL-FO",permalink:"/content/tags/xsl-fo"}],readingTime:2.015,hasTruncateMarker:!0,authors:[{name:"Adrian Png",title:"Senior Cloud Solutions Architect @ Insum",url:"https://github.com/fuzziebrain",imageURL:"https://github.com/fuzziebrain.png",key:"fuzziebrain"}],frontMatter:{title:"Generating XSL-FO Layouts with Microsoft Word and Apache POI",tags:["Apache POI","Java","Microsoft Word","Oracle Application Express","Oracle BI Publisher","PDF","reporting","XPath","XSL-FO"],slug:"id/332",authors:["fuzziebrain"],comment:!1,categories:["Technology","Programming","Oracle Application Express"],date:"2013-05-31T20:53:46.000Z"},prevItem:{title:"Post-KScope Blues",permalink:"/content/id/391"},nextItem:{title:"My KScope Experience (and Desires)",permalink:"/content/id/274"}},p={authorsImageUrls:[void 0]},s=[{value:"Step 1",id:"step-1",level:3},{value:"Step 2",id:"step-2",level:3},{value:"Step 3",id:"step-3",level:3},{value:"Step 4",id:"step-4",level:3},{value:"Step 5",id:"step-5",level:3},{value:"Step 6",id:"step-6",level:3},{value:"Step 7",id:"step-7",level:3},{value:"Step 8",id:"step-8",level:3},{value:"Step 9",id:"step-9",level:3},{value:"Step 10",id:"step-10",level:3},{value:"Step 11",id:"step-11",level:3},{value:"Step 12",id:"step-12",level:3}],c={toc:s};function d(e){let{components:t,...o}=e;return(0,n.mdx)("wrapper",(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.mdx)("p",null,"The objective of this post is to describe how to create XSL-FO Layouts with little or no costs! These can then be used\xa0for custom ",(0,n.mdx)("a",{parentName:"p",href:"http://www.slideshare.net/",title:"SlideShare"},"PDF documents"),"\xa0printing in ",(0,n.mdx)("a",{parentName:"p",href:"http://apex.oracle.com",title:"Oracle Application Express"},"Oracle Application Express")," (APEX)."),(0,n.mdx)("p",null,"Let's get started..."),(0,n.mdx)("p",null,"Tools that you will need:"),(0,n.mdx)("ol",null,(0,n.mdx)("li",{parentName:"ol"},(0,n.mdx)("a",{parentName:"li",href:"http://office.microsoft.com/en-us/word/",title:"Microsoft Word"},"Microsoft Word")," 97 and up."),(0,n.mdx)("li",{parentName:"ol"},(0,n.mdx)("a",{parentName:"li",href:"http://poi.apache.org",title:"Apache POI"},"Apache POI")," binaries.")),(0,n.mdx)("h3",{id:"step-1"},"Step 1"),(0,n.mdx)("p",null,"Design your report template using Microsoft Word and populate the document with variable placeholders.\n",(0,n.mdx)("img",{alt:"Design the form/report",src:r(12803).Z,width:"1383",height:"675"})),(0,n.mdx)("h3",{id:"step-2"},"Step 2"),(0,n.mdx)("p",null,"Save this template as a ",(0,n.mdx)("u",null,"Word 97-2003")," document."),(0,n.mdx)("h3",{id:"step-3"},"Step 3"),(0,n.mdx)("p",null,"Download the latest Apache POI binaries. At the time of writing, the latest version is 3.9 and the utility needed is still under development. The two ",(0,n.mdx)("a",{parentName:"p",href:"http://www.oracle.com/technetwork/java/",title:"Java (programming language)"},"Java")," library (jar) files are highlighted.\n",(0,n.mdx)("img",{alt:"Files in Apache POI",src:r(40197).Z,width:"596",height:"333"})),(0,n.mdx)("h3",{id:"step-4"},"Step 4"),(0,n.mdx)("p",null,"Extract the package and change the current directory to the folder the files were extracted to."),(0,n.mdx)("h3",{id:"step-5"},"Step 5"),(0,n.mdx)("p",null,"For convenience, copy/move the template document to the same directories as the Java libraries."),(0,n.mdx)("h3",{id:"step-6"},"Step 6"),(0,n.mdx)("p",null,"Perform the Word to FO conversion. Enter the command as highlighted.\n",(0,n.mdx)("img",{alt:"Executing the Word-to-FO Conversion Process",src:r(49233).Z,width:"677",height:"342"})),(0,n.mdx)("h3",{id:"step-7"},"Step 7"),(0,n.mdx)("p",null,"The contents of the FO file should be something similar to this:\n",(0,n.mdx)("img",{alt:"Sample Contents",src:r(73345).Z,width:"1168",height:"645"})),(0,n.mdx)("h3",{id:"step-8"},"Step 8"),(0,n.mdx)("p",null,"Place the contents of this file - stuff between the ","<","fo:root",">"," element - within a transformation template.\n",(0,n.mdx)("img",{alt:"XSLT Template",src:r(30451).Z,width:"857",height:"148"})),(0,n.mdx)("p",null,"Note: If ",(0,n.mdx)("a",{parentName:"p",href:"http://www.oracle.com/technology/products/xml-publisher/index.html",title:"Oracle BI Publisher"},"Oracle BI Publisher")," is used to generate the PDFs, then remove the and any child elements within. Consulting the ",(0,n.mdx)("a",{parentName:"p",href:"http://docs.oracle.com/cd/E28280_01/bi.1111/e22254/toc.htm"},"docs")," for supported elements would be helpful."),(0,n.mdx)("h3",{id:"step-9"},"Step 9"),(0,n.mdx)("p",null,"Replace the placeholders defined in the Word document with elements.\n",(0,n.mdx)("img",{alt:"Placeholders to be replaced",src:r(50079).Z,width:"1168",height:"483"})),(0,n.mdx)("p",null,"Use ",(0,n.mdx)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/XPath",title:"XPath"},"XPath")," to select the values from the ",(0,n.mdx)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/XML",title:"XML"},"XML")," data file generated by APEX.\n",(0,n.mdx)("img",{alt:"Embedding Query Results using XPath",src:r(7727).Z,width:"1168",height:"425"})),(0,n.mdx)("h3",{id:"step-10"},"Step 10"),(0,n.mdx)("p",null,"Images would be removed and replaced by a placeholder comment tag.\n",(0,n.mdx)("img",{alt:"Image Placeholder",src:r(86559).Z,width:"1168",height:"543"})),(0,n.mdx)("h3",{id:"step-11"},"Step 11"),(0,n.mdx)("p",null,"Include the image file as ","<","fo:external-graphic",">"," elements.\n",(0,n.mdx)("img",{alt:"Adding an External Graphic",src:r(79692).Z,width:"1168",height:"548"})),(0,n.mdx)("h3",{id:"step-12"},"Step 12"),(0,n.mdx)("p",null,'Save the file with an XML extension. To see this template in action, click on the "Print" button ',(0,n.mdx)("a",{parentName:"p",href:"http://apex.oracle.com/pls/apex/f?p=69146:301:0::::P301_EMPNO:7782"},"here"),"."),(0,n.mdx)("p",null,"Known Issue: The graphics element renders correctly when using Oracle APEX Listener 2.0 embedded Apache FOP print rendering engine, but not on apex.oracle.com, which uses Oracle BI Publisher. I am still trying to figure out why and if you do know the reason, I'd be happy if you could share it with me. Thanks! :-)"))}d.isMDXComponent=!0},12803:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_06-89371678232f794221fb7ffa499d515d.png"},40197:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_07-b8ef4fa40764a5105b652329fb4651b9.png"},49233:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_09-ca84b4bf52cbc18367c77b56d3c70fdd.png"},73345:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_10-2a3318bc38f22dd1867694bdc5b7ca17.png"},30451:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_11-9fb6de42180c158d22fe4c963492fdfd.png"},86559:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_13-5e4021c2c0441be63498c62ec2e7a500.png"},79692:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_14-4120bcfcced257da704c36b9d149581f.png"},50079:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_15-0416213c70a1eb5cb569f5600fe9b84b.png"},7727:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/apex_custom_pdf_report_17-fc48d4c2782151c38e14f302f9e9ea26.png"}}]);