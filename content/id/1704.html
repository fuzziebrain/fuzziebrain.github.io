<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Mail Dropped | Thinking Anew</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://fuzziebrain.com/content/id/1704"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Mail Dropped | Thinking Anew"><meta data-rh="true" name="description" content="Screen capture of http://www.mail-tester.com/ Results"><meta data-rh="true" property="og:description" content="Screen capture of http://www.mail-tester.com/ Results"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2017-08-20T12:50:06.000Z"><meta data-rh="true" property="article:author" content="https://github.com/fuzziebrain"><meta data-rh="true" property="article:tag" content="email,smtp,spf,orclapex,oxar,devops,linode"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://fuzziebrain.com/content/id/1704"><link data-rh="true" rel="alternate" href="https://fuzziebrain.com/content/id/1704" hreflang="en"><link data-rh="true" rel="alternate" href="https://fuzziebrain.com/content/id/1704" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/content/rss.xml" title="test RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/content/atom.xml" title="test Atom Feed">
<link rel="alternate" type="application/json" href="/content/feed.json" title="test JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-10103110-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K08RTKFLLX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-K08RTKFLLX",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.15d21e5d.css">
<script src="/assets/js/runtime~main.3fb6c759.js" defer="defer"></script>
<script src="/assets/js/main.1cfcdf3c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Thinking Anew</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Blog</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/content">Latest</a></li><li><a class="dropdown__link" href="/content/tags">Tags</a></li></ul></div><a class="navbar__item navbar__link" href="/tech-tnt">Tech TnT</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about-me">About Me</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/genai-made-easy">GenAI Made Easy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/a-yearful-of-ai-but-whats-next">A Yearful of AI But What&#x27;s Next?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/generate-art-using-diffusion-models-and-nfc-tags">Generate Art Using Latent Diffusion Models and NFC Tags</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/deploy-and-use-fine-tuned-llms-in-oracle-apex">Deploy and Use Fine-Tuned LLMs in Oracle APEX</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/predict-the-rugby-world-cup-2023-winner">Predict the Rugby World Cup 2023 Winner</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/closing-the-era-of-the-apex-challenge-coin">Closing the Era of the APEX Challenge Coin</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/speaking-ai-to-your-oracle-database">Speaking AI to Your Oracle Database</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/train-an-ai-model-to-recognize-oracle-apex-challenge-coins">Train an AI Model to Recognize Oracle APEX Challenge Coins</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/revolutionising-language-learning">Revolutionising Language Learning: How AI and Oracle APEX Transform Everyday Challenges</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/content/say-hello-from-an-autonomous-database">Say Hello From An Autonomous Database</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Screen capture of http://www.mail-tester.com/ Results"><header><h1 class="title_f1Hy" itemprop="headline">Mail Dropped</h1><div class="container_mt6G margin-vert--md"><time datetime="2017-08-20T12:50:06.000Z" itemprop="datePublished">August 20, 2017</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/fuzziebrain" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/fuzziebrain.png" alt="Adrian Png" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/fuzziebrain" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Adrian Png</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Cloud Solutions Architect @ Insum</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p><img decoding="async" loading="lazy" alt="Screen capture of http://www.mail-tester.com/ Results" src="/assets/images/before-ce7401b7b5ad883fd2e80ce2e2769278.png" width="1280" height="800" class="img_ev3q"></p>
<p>Before I begin, I just wanted to be absolutely clear that this post has nothing to do with Apple&#x27;s nifty <a href="https://support.apple.com/kb/ph2629" target="_blank" rel="noopener noreferrer">tool</a> for sending out large email attachments.</p>
<p>In my previous <a href="/content/id/cizx69jya000ra0pvv26u3cez">post</a>, I shared an approach for creating your very own <a href="https://apex.oracle.com/" target="_blank" rel="noopener noreferrer">Oracle Application Express</a> (APEX) instance on a small budget. Briefly, the solution involves using <a href="https://www.vagrantup.com/" target="_blank" rel="noopener noreferrer">Vagrant</a> to create a very affordable virtual machine (VM) on <a href="https://www.linode.com/?r=41672b20d515344de465e9ed44c1a75356445597" target="_blank" rel="noopener noreferrer">Linode&#x27;s</a> pool of servers and run the <a href="https://github.com/OraOpenSource/OXAR" target="_blank" rel="noopener noreferrer">OXAR</a> build script, to setup the APEX instance very quickly and painlessly.</p>
<p>However, all that power (and savings) comes with great responsibilty.</p>
<p>Without the aid of managed services, the passionate APEX developer will have to handle the day-to-day administration of the system and database. One of the common tasks required of a developer is to ensure emails can be sent from APEX appplications successfully. This not only involves understanding how to use the APIs to generate and send emails, but also knowledge on maximizing the chance that emails are delivered successfully to the intended audience and do not end up in the spam bin.</p>
<p>So what&#x27;s involved in getting email setup on your OXAR instance?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-one">Part One<a href="#part-one" class="hash-link" aria-label="Direct link to Part One" title="Direct link to Part One">​</a></h2>
<p>Ensure that a suitable mail daemon is running on your server. If you used the method that I prescribed in my earlier post, then you would be running a <a href="https://www.centos.org/" target="_blank" rel="noopener noreferrer">CentOS</a> 7 server with <a href="http://www.postfix.org/" target="_blank" rel="noopener noreferrer">Postfix</a> installed, but not running on boot. Let&#x27;s be sure by executing the following command:
<code>&gt; sudo rpm -q postfix</code></p>
<p>If Postfix is installed, you should see an output with the full package name, e.g. <code>postfix-2.10.1-6.el7.x86_64</code>.</p>
<p>If absent, install it using yum by executing the command:
<code>&gt; sudo yum install -y postfix</code></p>
<p>Next, check that the service is running by executing the command:
<code>&gt; sudo systemctl is-active postfix</code></p>
<p>The screen output should provide some clues about whether the service has been started and/or enabled to start on boot:</p>
<ul>
<li><code>active</code> ⇒ service is running</li>
<li><code>inactive</code> ⇒ service is not running but enabled</li>
<li><code>unknown</code> ⇒ service is not running and not enabled</li>
</ul>
<p>If the service is in <code>active</code> state, then check that it is also enabled to start on boot by executing the command:
<code>&gt; sudo systemctl is-enabled postfix</code></p>
<p>The system should respond with either <code>enabled</code> or <code>disabled</code>.</p>
<p>To enable the service to start on boot, execute:
<code>&gt; sudo systemctl enable postfix</code></p>
<p>To start the service:
<code>&gt; sudo systemctl start postfix</code></p>
<p>Next, configure Postfix if necessary. In most situations, you can use Postfix to send emails directly. If that is the case, the default configuration should generally work just fine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="email-relay">Email Relay<a href="#email-relay" class="hash-link" aria-label="Direct link to Email Relay" title="Direct link to Email Relay">​</a></h3>
<p>Some developers have access to SMTP servers and might like to use them to circumvent spam-related issues. It would be prudent to assume that these servers, if exposed to remote requests, will require authentication. And because it is the Internet, using a secured network protocol to authenticate is highly recommended. If you have no problems setting up SSL/TLS support for SMTP connections, then you might not want to use Postfix at all. You can configure the SMTP host, port and credentials in the APEX Instance Administration. this is addressed in Part Two.</p>
<p>However, if you are unable to set up a secure connection, then consider using Postfix by configuring it as a secure relay. I will use Gmail as an example. Here&#x27;s what you need to do:</p>
<ol>
<li>Install Cyrus <a href="https://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer" target="_blank" rel="noopener noreferrer">SASL</a> plain authentication package:
<code>&gt; sudo yum install -y cyrus-sasl-plain</code></li>
<li>Execute the command:
<code>&gt; sudo echo &quot;smtp.gmail.com myaccount@gmail.com:mysecurepassword&quot; &gt; /etc/postfix/sasl_passwd&quot;</code></li>
<li>Execute the next command to hash the file to protect it from prying eyes:
<code>&gt; sudo postmap hash:/etc/postfix/sasl_passwd</code></li>
<li>Don&#x27;t leave the plain text file lying around:
<code>&gt; sudo rm -f /etc/postfix/sasl_passwd</code></li>
<li>Configure Postfix stored in the configuration file <code>/etc/postfix/main.cf</code>. Place the following lines under the section <em>INTERNET OR INTRANET</em>:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">smtp_sasl_auth_enable = yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_sasl_security_options = noanonymous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_tls_security_level = secure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_tls_mandatory_protocols = TLSv1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_tls_mandatory_ciphers = high</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_tls_secure_cert_match = nexthop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">smtp_tls_CAfile = /etc/pki/tls/certs/ca-bundle.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">relayhost = smtp.gmail.com:587</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>Restart Postfix:
<code>&gt; sudo systemctl restart postfix</code></li>
</ol>
<p><strong>IMPORTANT:</strong> To send emails using Gmail&#x27;s SMTP servers, you may need to change your account access to <a href="https://support.google.com/accounts/answer/6010255" target="_blank" rel="noopener noreferrer">allow access from less secure apps</a>.</p>
<p><em>Attribution: The method for configuring Postfix to relay emails through Gmail was adapted from Charles Auer&#x27;s <a href="https://charlesauer.net/tutorials/centos/postfix-as-gmail-relay-centos.php" target="_blank" rel="noopener noreferrer">post</a>.</em></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ipv6">IPv6<a href="#ipv6" class="hash-link" aria-label="Direct link to IPv6" title="Direct link to IPv6">​</a></h3>
<p>If you are not prepared to deal with IPv6 configuration and issues, then you might want to also limit the network protocol that Postfix uses. Update this configuration in <code>/etc/postfix/main.cf</code> and then restart the service.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">inet_protocols = ipv4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-two">Part Two<a href="#part-two" class="hash-link" aria-label="Direct link to Part Two" title="Direct link to Part Two">​</a></h2>
<p>Configuring the APEX instance for email is simple. The documentation for how to do this is well documented in the <a href="https://docs.oracle.com/database/apex-5.1/AEADM/configuring-instance-settings.htm#GUID-FEC98D5E-3C89-423E-9603-4CD2E553BA34" target="_blank" rel="noopener noreferrer">docs</a> so I will not explain at length. In a nutshell:</p>
<ol>
<li>Login to the Instance Administration page</li>
<li>Click Manage Instance</li>
<li>Click Instance Settings</li>
<li>Click the Email tab</li>
<li>Enter the following:
a. SMTP Host Address - set to <code>localhost</code>
b. SMTP Host Port - set to <code>25</code> or whatever port you used in the Postfix configuration</li>
<li>Click Apply Changes to save</li>
<li>Ensure the proper network ACL has been set to allow the &quot;APEX schema&quot; to communicate with <code>localhost</code>.</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Instance Administration - Instance Settings - Email" src="/assets/images/apex-email-settings-45ad140ef509e86c144d5e7c4b7bad37.png" width="1280" height="800" class="img_ev3q"></p>
<p>An easy way to test the service is to run the following procedure block using SQL Workshop&#x27;s <a href="https://docs.oracle.com/database/apex-5.1/AEUTL/SQL-commands.htm#AEUTL220" target="_blank" rel="noopener noreferrer">SQL Commands</a> interface:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apex_mail</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p_to </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;myfriend@email.com&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p_from </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;me@myselfandi.com&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p_subj </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Popularity of Semantic Web Today&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p_body </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> q</span><span class="token string" style="color:#e3116c">&#x27;[</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        The 2017 Gartner Hype Cycle indicates that Semantic Web-related </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        technologies are heading past the trough of disillusionment. </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        We should investigate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">]&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p_body_html </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> q</span><span class="token string" style="color:#e3116c">&#x27;[</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &lt;p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          The 2017 Gartner Hype Cycle indicates that Semantic Web-related </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          technologies are heading past the trough of disillusionment. We </span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">          should investigate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        &lt;/p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">]&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  apex_mail</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">push_queue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-three">Part Three<a href="#part-three" class="hash-link" aria-label="Direct link to Part Three" title="Direct link to Part Three">​</a></h2>
<p>The third and final piece that I&#x27;d like to talk about in this post is to get pass spam filters and allowing emails to arrive safely in your intended receipients&#x27; inbox.</p>
<p>The following are a list of checks that spam filters typically use to assess an incoming email.</p>
<ul>
<li>HELO Greeting Check</li>
<li>Reverse DNS Check</li>
<li><a href="http://www.openspf.org/" target="_blank" rel="noopener noreferrer">Sender Policy Framework</a> (SPF)</li>
<li>Domain Keys (<a href="http://www.dkim.org/" target="_blank" rel="noopener noreferrer">DKIM</a>)</li>
<li><a href="http://spamassassin.apache.org/" target="_blank" rel="noopener noreferrer">SpamAssassin</a> content checks</li>
<li><a href="https://en.wikipedia.org/wiki/Bounce_Address_Tag_Validation" target="_blank" rel="noopener noreferrer">BATV</a> (Bounce Address Tag Validation)</li>
<li>Blacklisting<!-- -->
<ul>
<li><a href="http://www.dnsbl.info/" target="_blank" rel="noopener noreferrer">DNSBL</a></li>
<li><a href="http://uribl.com/" target="_blank" rel="noopener noreferrer">URIBL</a></li>
</ul>
</li>
</ul>
<p>The easiest checks to get past is ensuring that your DNS records are correct. The HELO greeting simply checks that your domain has a valid forward and reverse entry. The latter might be a little harder to achieve since PTR records, reverse DNS mappings, are usually managed by the organization that issued the IP address. Most spam filters recognize this and would accept the email as long as there is one.</p>
<p>The single most important factor seems to be how the SPF records are set for your domain. It&#x27;s not difficult for anyone to setup a SMTP server and with an appropriate email api/client, spoof a domain that he/she does not own and send out unauthorized emails. For example, if your APEX application attempts to use an <em>@yahoo.com</em> or <em>@gmail.com</em> email address sent from an unauthorized SMTP server, then these emails will likely be flagged as spam. Servers with strict policies might even outrightly reject these emails.</p>
<p>SPF is a <strong>single</strong> <a href="https://en.wikipedia.org/wiki/TXT_record" target="_blank" rel="noopener noreferrer">TXT</a> record in the DNS that uses <a href="http://www.openspf.org/Mechanisms" target="_blank" rel="noopener noreferrer">mechanisms</a> to help verify if the incoming email originated from an authorized source. Commonly used mechanisms include: <code>a</code>, <code>mx</code>, <code>include</code>, <code>ip4</code> and <code>all</code>. Each mechanism in the record can have one of four qualifiers (<code>-</code> ⇒ fail, <code>~</code> ⇒ softfail, <code>+</code> ⇒ pass or <code>?</code> ⇒ neutral) that email filters could then use to decide on whether to flag as spam.</p>
<p>Below is the SPF record for the domain <code>bcoug.org</code>. It begins with the SPF version number and then six mechanisms. Five of them state different ways to resolve an authorized source. The last is a catch-all to state that the email source is unauthorized.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">v=spf1 a mx include:_spf.google.com include:servers.mcsv.net ip4:204.244.186.184/32 ~all</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Before adding a SPF record to your DNS, test it first using the <a href="http://www.kitterman.com/spf/validate.html" target="_blank" rel="noopener noreferrer">tool</a> provided by Kitterman. Add it to your DNS only when the SPF record validates successfully and can correctly identify your SMTP server as an authorized server for the specified domain.</p>
<p><img decoding="async" loading="lazy" alt="Inputs to test a what-if email was sent from my personal APEX instance" src="/assets/images/spf-validate-form-e4609fe1fa8c68bcea84be93cdfd74c2.png" width="1280" height="800" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Results" src="/assets/images/spf-validate-results-2669bb36f5738fe7f9392d7b8098fb2b.png" width="1280" height="223" class="img_ev3q"></p>
<p>After adding the SPF record, check to see if the record is being read correcly. You can use <a href="https://mxtoolbox.com/" target="_blank" rel="noopener noreferrer">MxToolBox</a> for this. Here&#x27;s what the SPF record for the domain <code>bcoug.org</code> looks like:</p>
<table><thead><tr><th>Prefix</th><th>Type</th><th>Value</th><th>PrefixDesc</th><th>Description</th></tr></thead><tbody><tr><td>v</td><td>version</td><td>spf1</td><td></td><td>The SPF record version</td></tr><tr><td>+</td><td>a</td><td></td><td>Pass</td><td>Match if IP has a DNS &#x27;A&#x27; record in given domain</td></tr><tr><td>+</td><td>mx</td><td></td><td>Pass</td><td>Match if IP is one of the MX hosts for given domain name</td></tr><tr><td>+</td><td>include</td><td>_spf.google.com</td><td>Pass</td><td>The specified domain is searched for an &#x27;allow&#x27;.</td></tr><tr><td>+</td><td>include</td><td>servers.mcsv.net</td><td>Pass</td><td>The specified domain is searched for an &#x27;allow&#x27;.</td></tr><tr><td>+</td><td>ip4</td><td>204.244.186.184/32</td><td>Pass</td><td>Match if IP is in the given range</td></tr><tr><td>~</td><td>all</td><td></td><td>SoftFail</td><td>Always matches. It goes at the end of your record.</td></tr></tbody></table>
<p><strong>NOTE:</strong> Since <code>bcoug.org</code> resolves to IPv4 <code>204.244.186.184</code>, the ip4 mechanism can be omitted.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="evaluate-your-emails-spamminess">Evaluate Your Email&#x27;s Spamminess<a href="#evaluate-your-emails-spamminess" class="hash-link" aria-label="Direct link to Evaluate Your Email&#x27;s Spamminess" title="Direct link to Evaluate Your Email&#x27;s Spamminess">​</a></h3>
<p>Here&#x27;s a bunch of tools I gathered from websites and <a href="https://stackoverflow.com/" target="_blank" rel="noopener noreferrer">stackoverflow</a> posts that are useful for evaluating your emails (content, SPF records etc.) and creating an actionalble checklist. They have helped me quite a bit, so I&#x27;m counting on them to do the same for you!</p>
<table><thead><tr><th>Link</th><th>Description</th></tr></thead><tbody><tr><td><a href="http://www.mail-tester.com/" target="_blank" rel="noopener noreferrer">http://www.mail-tester.com/</a></td><td>Create an email and send it through your designated SMTP server.</td></tr><tr><td><a href="http://www.allaboutspam.com/" target="_blank" rel="noopener noreferrer">http://www.allaboutspam.com/</a></td><td>Like Mail Tester, send an email through your designated SMTP server.</td></tr><tr><td><a href="http://spamcheck.postmarkapp.com/" target="_blank" rel="noopener noreferrer">http://spamcheck.postmarkapp.com/</a></td><td>Copy and paste an email with its headers to get a SpamAssassin score.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="outcome">Outcome<a href="#outcome" class="hash-link" aria-label="Direct link to Outcome" title="Direct link to Outcome">​</a></h3>
<p>After taking my APEX instance through cycles of corrective actions, I was finally able to achieve a score of 9/10. Where I fell short of a perfect score, is the absence of <a href="https://en.wikipedia.org/wiki/DomainKeys" target="_blank" rel="noopener noreferrer">DomainKeys</a> (DKIM) information. I have yet to implement DKIM support for my APEX instance, so stay tuned, and you can expect a follow up howto post.</p>
<p><img decoding="async" loading="lazy" alt="Results after the appropriate SPF records are added" src="/assets/images/after-7304616b3692cb91848841c3b2df3861.png" width="1280" height="800" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="last-words">Last Words<a href="#last-words" class="hash-link" aria-label="Direct link to Last Words" title="Direct link to Last Words">​</a></h2>
<p>I hope this information here saves you some time figuring out what you need to do to stay out of the junk mail folder. Before I end though, here are a few more notes:</p>
<ul>
<li>Watch your content, even when performing checks on the validity of your emails.</li>
<li>Include HTML content and make sure there are no broken links if any.</li>
<li>Do your best to stay off any blacklists. It&#x27;s a huge challenge getting your mail server delisted.</li>
</ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/email">email</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/smtp">smtp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/spf">spf</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/orclapex">orclapex</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/oxar">oxar</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/devops">devops</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/content/tags/linode">linode</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/content/id/1705"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Real Uptime Monitoring of Oracle APEX Instances</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/content/id/1703"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">The Community is One of Oracle APEX&#x27;s Best Features</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#part-one" class="table-of-contents__link toc-highlight">Part One</a><ul><li><a href="#email-relay" class="table-of-contents__link toc-highlight">Email Relay</a></li><li><a href="#ipv6" class="table-of-contents__link toc-highlight">IPv6</a></li></ul></li><li><a href="#part-two" class="table-of-contents__link toc-highlight">Part Two</a></li><li><a href="#part-three" class="table-of-contents__link toc-highlight">Part Three</a><ul><li><a href="#evaluate-your-emails-spamminess" class="table-of-contents__link toc-highlight">Evaluate Your Email&#39;s Spamminess</a></li><li><a href="#outcome" class="table-of-contents__link toc-highlight">Outcome</a></li></ul></li><li><a href="#last-words" class="table-of-contents__link toc-highlight">Last Words</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/content">Latest</a></li><li class="footer__item">
                  <a href="/content/tags" class="footer__link-item">
                    <i class="fa-solid fa-magnifying-glass"></i> Find by Tags
                  </a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Tech TnT</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/tech-tnt/category/oracle-cloud">Oracle Cloud</a></li><li class="footer__item">
                  <a href="/tech-tnt/tags" class="footer__link-item">
                    <i class="fa-solid fa-magnifying-glass"></i> Find by Tags
                  </a>
                </li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/adrianp" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://mastodon.social/@fuzziebrain" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/fuzziebrain" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Adrian Png. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>